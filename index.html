<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Odontograma 3D</title>
		
		<!-- Stylesheets -->
		<link rel="stylesheet" href="stylesheets/main.css" type="text/css" />
		
		<!-- Libraries JavaScript -->
		<script type="text/javascript" src="lib/three.min.js"></script>
		<script type="text/javascript" src="lib/OBJLoader.js"></script>
		<script type="text/javascript" src="lib/OrbitControls.js"></script>
	</head>
	<body>
		<script type="text/javascript">
			var camera, scene, renderer, container, cube, controls, ambient, tooth, spotlLight;
			
			init();
			render();
			
			// Init function
			function init(){
				// Container
				container = document.createElement('div');
				container.className = "container_tooth";
				container.id = "container_tooth";
				document.body.appendChild(container);
				
				// Camera
				camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
				camera.position.set(0, -120, 300);
				
				// Scene
				scene = new THREE.Scene();
				
				// renderer
				renderer = new THREE.WebGLRenderer({ 
					antialias: true, 
					// alpha: true
				});
				renderer.shadowMapEnabled = true;
				renderer.setPixelRatio(window.devicePixelRatio);
				renderer.setSize(window.innerWidth, window.innerHeight);
				renderer.setClearColor( 0x000000 );
				renderer.domElement.id = "canvas_3d"; // agrego un id al canvas que renderiza el diente
				container.appendChild(renderer.domElement);
				
				// plane for the ground
				var planeGeometry = new THREE.PlaneBufferGeometry(10, 20, 32);
				var planeMaterial = new THREE.MeshBasicMaterial( { color: 0x000000 } );
				var plane = new THREE.Mesh( planeGeometry, planeMaterial );
				plane.position.set(0, 0, -1);
				// scene.add( plane );
				
				scene.add( new THREE.AmbientLight( 0x443333 ) );
				
				var light = new THREE.DirectionalLight( 0xffddcc, 1 );
				light.position.set( 1, 0.75, 0.5 );
				scene.add( light );
	
				var light = new THREE.DirectionalLight( 0xccccff, 1 );
				light.position.set( -1, 0.75, -0.5 );
				scene.add( light );
	
				var geometry = new THREE.Geometry();
				geometry.vertices.push( new THREE.Vector3(), new THREE.Vector3() );
	
				line = new THREE.Line( geometry, new THREE.LineBasicMaterial( { linewidth: 4 } ) );
				scene.add( line );
	
				raycaster = new THREE.Raycaster();
	
				var mouseHelper = new THREE.Mesh( new THREE.BoxGeometry( 1, 1, 10 ), new THREE.MeshNormalMaterial() );
				mouseHelper.visible = false;
				scene.add( mouseHelper );
				
				var geometry = new THREE.BoxGeometry( 30, 30, 30 );
				var material = new THREE.MeshBasicMaterial( { color: 0xaaaaaa } );
				cube = new THREE.Mesh( geometry, material );
				cube.position.set(100, 50, -50);
				// scene.add( cube );
				
				// Ambient light 
				ambient = new THREE.AmbientLight( 0xffffff );
				scene.add(ambient);
				
				// Other light
				spotlLight = new THREE.SpotLight( 0xb4e7f2, 1.8 );
				spotlLight.position.set(100, -100, 100);
				spotlLight.castShadow = true;
				spotlLight.shadowMapWidth = 1024;
				spotlLight.shadowMapHeight = 1024;
				spotlLight.shadowCameraNear = 500;
				spotlLight.shadowCameraFar = 4000;
				spotlLight.shadowCameraFov = 30;
			//	scene.add(spotlLight);
				
				// Load object
				var loader = new THREE.OBJLoader();
				
				loader.load(
					'tooth_molar.obj',
					function(object){
						tooth = object;
						object.scale.set(2, 2, 2);
						object.rotation.x = 45;
						object.rotation.y = 2;
						scene.add(object);
					}
				);
				
				controls = new THREE.OrbitControls( camera, renderer.domElement );
				controls.minDistance = 37;
				controls.maxDistance = 150;
				
				// Camera look at
				camera.lookAt( plane.position );
			}
			
			// funtion to render object
			function render(){
				requestAnimationFrame(render);
				
				controls.update();
				
				// cube.rotation.x += 0.1;
				// cube.rotation.y += 0.1;
				
				renderer.render(scene, camera);
			}
		</script>
	</body>
</html>